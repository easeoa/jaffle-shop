models:
  - name: supplies
    description: 供給概要データマート。各供給と製品の組み合わせの詳細情報を提供します。供給と製品の組み合わせ1つにつき1行です。
    columns:
      - name: supply_uuid
        description: 供給のユニークキー
        data_tests:
          - not_null
          - unique
      - name: supply_id
        description: 供給ID
      - name: product_id
        description: 製品を参照する外部キー
      - name: supply_name
        description: 供給名
      - name: supply_cost
        description: 供給コスト
      - name: is_perishable_supply
        description: 生鮮供給かどうかを示すブール値
    meta:
      metrics:
        supply_count:
          label: 供給数
          type: count_distinct
          sql: ${TABLE}.supply_uuid
        total_supply_cost:
          label: 総供給コスト
          type: sum
          sql: ${TABLE}.supply_cost
        average_supply_cost:
          label: 平均供給コスト
          type: average
          sql: ${TABLE}.supply_cost
        perishable_supply_count:
          label: 生鮮供給数
          type: count_distinct
          sql: case when ${TABLE}.is_perishable_supply then ${TABLE}.supply_uuid else null end
